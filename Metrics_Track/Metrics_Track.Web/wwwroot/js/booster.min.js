var sessLastActivity,idleTimer,remainingTimer,sess_intervalID,idleIntervalID,sess_lastActivity,timer,sessServerAliveTime=174e4,sessionTimeout=3222e4,isTimout=!1,isIdleTimerOn=!1;function sessPingServer(){if(!isTimout)return $.ajax({url:"/dashboard/StayAlive",dataType:"json",async:!1,type:"POST"}),!0}function sessServerAlive(){sess_intervalID=setInterval("sessPingServer()",sessServerAliveTime)}function initSessionMonitor(){$(document).bind("keypress.session",function(e,s){sessKeyPressed(e,s)}),$(document).bind("mousedown keydown",function(e,s){sessKeyPressed(e,s)}),sessServerAlive(),startIdleTime()}function sessKeyPressed(e,s){var n=e?e.target:window.event.srcElement,o=$(n).parents("#session-expire-warning-modal").length;null!==o&&void 0!==o&&"btnSessionExpiredCancelled"!==e.target.id&&"btnSessionModal"!==e.target.id&&"session-expire-warning-modal"!==e.currentTarget.activeElement.id&&"btnExpiredOk"!==e.target.id&&"modal fade modal-overflow in"!==e.currentTarget.activeElement.className&&"modal-header"!==e.currentTarget.activeElement.className&&1!==o&&"session-expire-warning-modal"!==e.target.id&&(localStorage.setItem("sessionSlide","isStarted"),startIdleTime())}function startIdleTime(){stopIdleTime(),localStorage.setItem("sessIdleTimeCounter",$.now()),idleIntervalID=setInterval("checkIdleTimeout()",6e4),isIdleTimerOn=!1}localStorage.setItem("sessionSlide","isStarted"),$(function(){window.setInterval(function(){$.get("/dashboard/StayAlive")},174e4)}),$(document).ready(function(e){localStorage.setItem("sessionSlide","isStarted"),startIdleTime()});var sessionExpired=document.getElementById("session-expired-modal");function sessionExpiredClicked(e){window.location="Logout.html"}function stopIdleTime(){clearInterval(idleIntervalID),clearInterval(remainingTimer)}function checkIdleTimeout(){var e=parseInt(localStorage.getItem("sessIdleTimeCounter"))+sessionTimeout;$.now()>e+1e4?($("#session-expire-warning-modal").modal("hide"),$("#session-expired-modal").modal("show"),clearInterval(sess_intervalID),clearInterval(idleIntervalID),$(".modal-backdrop").css("z-index",parseInt($(".modal-backdrop").css("z-index"))+100),$("#session-expired-modal").css("z-index",2e3),$("#btnExpiredOk").css("background-color","#428bca"),$("#btnExpiredOk").css("color","#fff"),isTimout=!0,sessLogOut()):$.now()>e&&(isIdleTimerOn||(localStorage.setItem("sessionSlide",!1),countdownDisplay(),$(".modal-backdrop").css("z-index",parseInt($(".modal-backdrop").css("z-index"))+500),$("#session-expire-warning-modal").css("z-index",1500),$("#btnOk").css("background-color","#428bca"),$("#btnOk").css("color","#fff"),$("#btnSessionExpiredCancelled").css("background-color","#428bca"),$("#btnSessionExpiredCancelled").css("color","#fff"),$("#btnLogoutNow").css("background-color","#428bca"),$("#btnLogoutNow").css("color","#fff"),$("#seconds-timer").empty(),$("#session-expire-warning-modal").modal("show"),isIdleTimerOn=!0))}function btnSessionExpiredCancelled(){$(".modal-backdrop").css("z-index",parseInt($(".modal-backdrop").css("z-index"))-500)}function btnOk(){$("#session-expire-warning-modal").modal("hide"),$(".modal-backdrop").css("z-index",parseInt($(".modal-backdrop").css("z-index"))-500),startIdleTime(),clearInterval(remainingTimer),localStorage.setItem("sessionSlide","isStarted")}function btnLogoutNow(){localStorage.setItem("sessionSlide","loggedOut"),sessLogOut()}function countdownDisplay(){var e=180;remainingTimer=setInterval(function(){"isStarted"===localStorage.getItem("sessionSlide")?($("#session-expire-warning-modal").modal("hide"),startIdleTime(),clearInterval(remainingTimer)):"loggedOut"===localStorage.getItem("sessionSlide")?($("#session-expire-warning-modal").modal("hide"),$("#session-expired-modal").modal("show")):($("#seconds-timer").html(e),e-=1)},1e3)}function sessLogOut(){var e=$('input[name="__RequestVerificationToken"]').val();$.ajax({type:"POST",url:"/account/logout",data:{__RequestVerificationToken:e},success:function(){},error:function(){window.location.href="/account/login"}})}$("#session-expired-modal").on("shown.bs.modal",function(){$("#session-expire-warning-modal").modal("hide"),$(this).before($(".modal-backdrop")),$(this).css("z-index",parseInt($(".modal-backdrop").css("z-index"))+1)}),$("#session-expired-modal").on("hidden.bs.modal",function(){window.location="Logout.html"}),$("#session-expire-warning-modal").on("shown.bs.modal",function(){$("#session-expire-warning-modal").modal("show"),$(this).before($(".modal-backdrop")),$(this).css("z-index",parseInt($(".modal-backdrop").css("z-index"))+1)});